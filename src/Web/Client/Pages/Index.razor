@page "/"
@attribute [Authorize]

@inject HttpClient _httpClient
@inject NavigationManager _navManager

@if(_organizations is not null)
{
    <MudPaper>
        <MudList Clickable="true">
            @foreach (var organization in _organizations.Organizations)
            {
                <MudListItem Text="@organization.Name" OnClick="() => SelectOrganization(organization.Id)" />
            }
        </MudList>
    </MudPaper>
}

@code {
    private RequestHandler _requestHandler = null!;

    private OrganizationsForUserVM? _organizations;

    protected override async Task OnInitializedAsync()
    {
        _requestHandler = new(_httpClient);
        _organizations = await _requestHandler.GetAsync<OrganizationsForUserVM>("organizations");
    }

    private void SelectOrganization(Guid organizationId)
    {
        _navManager.NavigateTo($"/org/{organizationId}");
    }
}
