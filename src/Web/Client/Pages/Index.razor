@page "/"
@attribute [Authorize]

@inject HttpClient _httpClient
@inject NavigationManager _navManager

@if(_organizations is not null)
{
    <MudPaper>
        <MudList Clickable="true">
            @foreach (var organization in _organizations.Organizations)
            {
                <MudListItem Text="@organization.Name" OnClick="() => SelectOrganization(organization.Id)" />
            }
        </MudList>
    </MudPaper>
}

@code {
    private OrganizationsForUserVM? _organizations;

    protected override async Task OnInitializedAsync()
    {
        var response = await _httpClient.GetAsync($"organizations");
        _organizations = await response.Content.ReadFromJsonAsync<OrganizationsForUserVM>();
    }

    private void SelectOrganization(Guid organizationId)
    {
        _navManager.NavigateTo($"/org/{organizationId}");
    }
}
